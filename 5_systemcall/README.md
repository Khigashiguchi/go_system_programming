# memo

## 5.1.1
os.Openfileの中身がosによってそれぞれ異なる実装をしている。

```$xslt
-> % ls /usr/local/Cellar/go/1.9.2/libexec/src/os | grep file
file.go
file_plan9.go
file_posix.go
file_unix.go
file_windows.go
```

差分として、例えば、、、

```go
// file_unix
const DevNull = "/dev/null"

// file_windows
const DevNull = "NUkL"
```

Unixの中でも更にMacとLinuxで処理が分かれる、その中身はコード生成されたものらしい

```bash
-> % ls /usr/local/Cellar/go/1.9.2/libexec/src/syscall | grep zsyscall_darwin
zsyscall_darwin_386.go
zsyscall_darwin_amd64.go
zsyscall_darwin_arm.go
zsyscall_darwin_arm64.go

```

```go
// THIS FILE IS GENERATED BY THE COMMAND AT THE TOP; DO NOT EDIT

func Open(path string, mode int, perm uint32) (fd int, err error) {
	var _p0 *byte
	_p0, err = BytePtrFromString(path)
	if err != nil {
		return
	}
	r0, _, e1 := Syscall(SYS_OPEN, uintptr(unsafe.Pointer(_p0)), uintptr(mode), uintptr(perm))
	fd = int(r0)
	if e1 != 0 {
		err = errnoErr(e1)
	}
	return
}
```


### POSIX
- Portable Operating System Interface
    - IEEE企画

### linux
- https://github.com/torvalds/linux
    - kernel code
- write system call
    - https://github.com/torvalds/linux/blob/master/fs/read_write.c#L607
    
### エラー処理
- Go言語は、errorインターフェースにエラーメッセージを格納して返すことが習慣

### Todo
- sudo csrutil disable
    - `dtrace: system integrity protection is on, some features will not be available
`